# Personal additions to .bashrc OR .zshrc files
parse_git_branch() {
     git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/(\1)/'
}

export PS1="\W \[\e[91m\]\$(parse_git_branch)\[\e[00m\]\$"

if [ -f ~/.scripts/.git-completion.bash ]; then
  . ~/.scripts/.git-completion.bash
fi

## docker bash completion for MacOS
if [ -f /Applications/Docker.app/Contents/Resources/etc/docker.bash-completion ]; then
  . /Applications/Docker.app/Contents/Resources/etc/docker.bash-completion
fi

## docker-compose bash completion for MacOS
if [ -f /Applications/Docker.app/Contents/Resources/etc/docker-compose.bash-completion ]; then
  . /Applications/Docker.app/Contents/Resources/etc/docker-compose.bash-completion
fi

shopt -s autocd

# vars:
export OWN_HOME="$HOME/personal/"
export WORK_HOME="$HOME/work/"
export LRN_HOME="$HOME/learn/"

# dirs:
alias personal="cd $OWN_HOME"
alias work="cd $WORK_HOME"
alias learn="cd $LRN_HOME"

# git:
alias gitPersonalConfig="git config user.email livrofubia@gmail.com && git config user.name \"Filipe Freire\""
alias gcmsg='git commit --reuse-message=HEAD@{1}'

# bash typical:
alias v='vim'
alias x='chmod u+x $(ls -tr | tail -1)'

# Uncomment if using maven:
# alias mvnci="mvn -U clean install"
# alias mvnx="mvn -U clean install -Pqulice"

# other:

if [ $(uname) == "Darwin" ]; then
  alias battery='pmset -g batt | grep "%" | awk "{print \$3}" | sed s/\;//g'
fi

# some more ls aliases
alias ll='ls -alF'
alias la='ls -A'
alias l='ls -CF'

alias jks='jekyll serve'
alias jksd='jekyll serve --drafts'

# Uncomment if using k8s
# alias k='kubectl'
# alias kgpo='kubectl get pods'
# alias kgjo='kubectl get jobs'
# alias kexec='kubectl exec -it'
# alias kdpo='kubectl describe pod'
# alias klogs='kubectl logs --follow'
# alias kpfw='kubectl port-forward'
# alias kgde='kubectl get deployments'
# alias kdde='kubectl describe deployment'
# alias kede='kubectl edit deployment'
# alias kgcf='kubectl get configmap'
# alias kdcf='kubectl describe configmap'
# alias kecf='kubectl edit configmap'
# alias kgall='kubectl get all'

##################################################################################################

# INCLUDING oh-my-git-aliases since I need them almost always...
# Taken from https://raw.githubusercontent.com/filfreire/oh-my-git-aliases/master/oh-my-git-aliases.sh

alias g='git'

alias gst='g status'

alias gfe='g fetch'

alias gco='g checkout'
alias gcd='gco develop'
alias gcm='gco master'

alias ggpush='g push origin $(current_branch)'
alias ggpushf='ggpush --force-with-lease'
alias ggpusht='g push origin --tags'

alias gc='g commit'
alias gc!='gc --amend'
alias gca='gc -a'
alias gca!='gca --amend'

alias gl='g pull'
alias glr='gl --rebase'
alias glff='gl --ff-only'

alias gm='g merge'
alias gmff='gm --ff-only'
alias gmnff='gm --no-ff'

alias ga='g add'
alias gap='ga --patch'
alias gai='ga -i'

alias gb='g branch'
alias gba='g branch -a'

alias ggr='git grep'

alias grb='g rebase'
alias grbi='grb --interactive'
alias grbiod='grbi origin/develop'
alias grbiom='grbi origin/master'
alias grbc='grb --continue'
alias grba='grb --abort'

alias gt='g tag'

alias gre='g reset'
alias greh='gre --hard'
alias ggrh='greh origin/$(current_branch)'

grf() {
        gre @~ "$@" && gc! --no-edit
}

alias gd='g diff'
alias gdo='gd origin/$(current_branch) $(current_branch)'

alias gcp='g cherry-pick'
alias gcpa='gcp --abort'
alias gcpc='gcp --continue'

alias gsts='git stash show --text'
alias gsta='g stash'
alias gstp='gsta pop'
alias gstd='gsta drop'

alias gcl='g clone'

alias gr='g remote'

# https://github.com/robbyrussell/oh-my-zsh
function current_branch() {
  ref=$(git symbolic-ref HEAD 2> /dev/null) || \
  ref=$(git rev-parse --short HEAD 2> /dev/null) || return
  echo ${ref#refs/heads/}
}

# uncomment in case you use vs code insiders version
# alias code='code-insiders'
